<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLOOR PLAN DETECTION</title>
    <link rel="icon" href="\static\logomitek.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <script src="/static/3-follow.js"></script>
    <link rel="stylesheet" href="/static/3-follow.css">

    <script type="text/javascript">  
        function selects(){  
            // var ele=document.getElementsByName('chk');  
            var checkboxes = document.querySelectorAll('input[type="checkbox"]');
            for(var i=0; i<checkboxes.length; i++){  
                if (checkboxes[i].disabled==false)                  
                checkboxes[i].checked=true;  
            }  
        }  
        function deSelect(){  
            // var ele=document.getElementsByName('chk');  
            var checkboxes = document.querySelectorAll('input[type="checkbox"]');
            for(var i=0; i<checkboxes.length; i++){        
                if (checkboxes[i].disabled==false)      
                    checkboxes[i].checked=false;          
            }  
        }             
    </script>  

    <script>
        function validateForm() {
            if (document.querySelectorAll('input[type="checkbox"]:checked').length == 0) {
                alert("MUST SELECT AT LEAST ONE OBJECT TO DETECT");
                return false;               
            }          
        }
    </script>

    <script>    
        jsondata = '{{ jsondata|tojson }}'; 
        const myObj = JSON.parse(jsondata);        
        function enableDisable(lst) {     
            const objects_set = new Set(lst["detect_objects_names"])            
            for (const x of objects_set.values()) {
                document.getElementById(x).checked=true;
                document.getElementById(x).disabled=false;    
                document.getElementsByName(x)[0].style.color='#25a4f8';
                document.getElementsByName(x)[0].style.fontWeight = 500;
            }              
        }            
    </script>
   
    <style>
        
        html, body, .container-fluid {
            height: 90%;
 
        }
        .column {
            float: right;
        }

        .left {
            width: 70%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .right {
            width: 30%;
            padding-left: 5%;
        }
        .button-end{
            margin-top: 40%;
            margin-bottom: 5%;
        }
        input{
            margin-right: 5px;
            border-radius: 5px;
        }
        label{
            color: #666;
            margin-right: 20px;
        }
        .display-8{
            color: whitesmoke;
            white-space: nowrap;
            margin-top: 5px;
        }
        .enabled {
            color: #25a4f8;
            font-weight: 500;
        }
        /* figure.zoom {
        background-position: 50% 50%;
        position: relative;
        width: 1250px;
        overflow: hidden;
        cursor: zoom-in; 
        background-repeat: no-repeat;
        }
        figure.zoom img:hover {
        opacity: 0;
        }
        figure.zoom img {
        transition: opacity .5s;
        display: block;
        width: 100%;
        } */
        /*  */
        .content {
            margin-top: 5px;
            /* background: #C3C3C3; */
            width: 100%;
            height: 100%;
            margin: auto;
        }

        .img-wrapper {
            display: flex;
            justify-content: center;
            width: auto;
            overflow: auto;
            margin: 0 auto;
        }

        .my-image {
            width: 100%;
            /* max-height: 1000px;  */
            transform-origin: top;
        }

        .slidecontainer {
            /* position: static; */
            bottom: 50px;
            margin-top: 50px;
        }
    </style>

</head>

<body onload="enableDisable(myObj)" style="background-color:#181818">
    <div class="container-fluid d-flex flex-column"> 
        <div class="row flex-fill">
            <div class="col d-flex flex-column column left">
                <h3 class="display-8"> AI DETECTED RESULT</h3>  
                <div class="content">
                    <div class="img-wrapper" id="img-wrapper">
                        <img id="bacon" class="my-image"
                            src="/static/display/original_pred.jpg"/>
                    </div>                                           
                </div>          
                                
                <!-- <figure class="zoom" onmousemove="zoom(event)" style="background-image: url(/static/display/original_pred.jpg);">
                    <img id= "imga" src="/static/display/original_pred.jpg" />
                </figure> -->

            </div>             
                <div class="column right" style="margin-top: 10%;">                        
                    <form id="form" method="post"  action="/result" onsubmit="return validateForm()">
                        <div class="row"  >
                                <div class="flex-parent jc-center" > 
                                    <h4 class="display-8"> Door-2Door-Window</h4>
                                </div>                        
                                <div class="flex-parent jc-center" >
                                    <input type="checkbox" name="object" value = "door" id="door" disabled>                          
                                    <label for="door" name='door'> door (Quantity: {{door_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="2door" id="2door" disabled>
                                    <label for="2door" name="2door"> 2door (Quantity: {{doubledoor_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="window1" id="window1" disabled>
                                    <label for="window1" name="window1"> window1 (Quantity: {{window1_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="window2" id="window2" disabled>
                                    <label for="window2" name="window2"> window2 (Quantity: {{window2_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="baywindow" id="baywindow" disabled>
                                    <label for="baywindow" name="baywindow"> baywindow (Quantity: {{baywindow_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="window4" id="window4" disabled>
                                    <label for="window4" name="window4"> window4 (Quantity: {{window4_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="window5" id="window5" disabled>
                                    <label for="window5" name="window5"> window5 (Quantity: {{window5_count}})</label><br>
                
                                    <input type="checkbox" name="object" value="window6" id="window6" disabled>
                                    <label for="window6" name="window6"> window6 (Quantity: {{window6_count}})</label><br>
                                </div>       
    
                            <div class="row">
                                <div class="flex-parent jc-center" style="margin-top: 5px;">
                                    <h4 class="display-8"> Wall</h4>
                                </div>                     
                                <div class="flex-parent jc-center" >                                                   
                                    <input type="checkbox" name="object" value="black_wall" id="black_wall" disabled>
                                    <label for="blackwall" name="black_wall">blackwall (Quantity: {{black_wall_count}})</label><br>
                        
                                    <input type="checkbox" name="object" value="white_wall" id="white_wall" disabled>
                                    <label for="whitewall" name="white_wall">whitewall (Quantity: {{white_wall_count}})</label><br>
                        
                                    <input type="checkbox" name="object" value="grey_wall" id="grey_wall" disabled>
                                    <label for="greywall" name="grey_wall">greywall (Quantity: {{grey_wall_count}})</label><br>
    
                                    <input type="checkbox" name="object" value="cross_wall" id="cross_wall" disabled>
                                    <label for="crosswall" name="cross_wall">crosswall (Quantity: {{cross_wall_count}})</label>
                                </div>
                            </div>
                            <div class="slidecontainer">
                                <input type="range" min="0" max="100" value="0" class="slider" id="img-slider">
                            </div>   
                            <script type="text/javascript">
                                function zoom(id, value) {
                                    var outerDiv = document.getElementById('img-wrapper');
                                    var scale = "scale(" + value + ");"
                                    var margin = 0;
                                    var origin = "top";        
                                    if (outerDiv.clientWidth !== outerDiv.scrollWidth) {
                                        origin = "top left";
                                        margin = 0 - outerDiv.clientWidth / 2;
                                    }
                                
                                    var style = "margin-left:" + margin + "px; -ms-transform:" + scale + "-webkit-transform:" + scale + "transform:" + scale + "transform-origin:" + origin + ";";
                                    
                                    document.getElementById(id).setAttribute("style", style);
                            
                                    outerDiv.scrollLeft = outerDiv.scrollWidth / 2 - outerDiv.clientWidth / 2;
                                }
                            
                            
                                var imgSlider = document.getElementById("img-slider");
                                imgSlider.oninput = function () {
                                    multiplier = 3;
                                    var zoomlevel = 1 + this.value / 100 * multiplier;
                                    zoom("bacon", zoomlevel);
                                }
                            
                            </script> 
                            <div class="button-end">
                                <input type="button" onclick='selects()' value="Select All" class="btn btn-outline-primary" style="margin-left: 15%;">   
                                <input type="button" onclick='deSelect()' value="Deselect All" class="btn btn-outline-primary">                                                     
                                <div>
                                    <br>                             
                                    <a href="/" class="btn btn-outline-primary">
                                        Home
                                    </a>                    
                                    <input type="submit"  value="Submit" style="margin-left: 44%;" class="btn btn-outline-primary">                         
                                </div> 
                            </div>  
                        </div>   
                                                                                   
                        </form>   
                </div> 
        </div>                 
    </div>
</body>
</html>
